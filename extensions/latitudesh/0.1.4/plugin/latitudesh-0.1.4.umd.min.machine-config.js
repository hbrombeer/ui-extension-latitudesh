(("undefined"!==typeof self?self:this)["webpackChunklatitudesh_0_1_4"]=("undefined"!==typeof self?self:this)["webpackChunklatitudesh_0_1_4"]||[]).push([[921],{332(e,t,a){"use strict";a.r(t),a.d(t,{default:()=>I});var l=a(9274);const s={key:1},i={class:"mb-0"},o={class:"row mb-20"},n={class:"col span-6"},r={class:"row mb-20"},d={class:"col span-6"},u={class:"row mb-20"},c={class:"col span-6"},p={class:"row mb-20"},h={class:"col span-6"},m={class:"row mb-20"},v={class:"col span-6"},b={class:"row mb-20"},g={class:"col span-6"},f={class:"row mb-20"},y={class:"col span-6"};function C(e,t,a,C,V,O){const N=(0,l.resolveComponent)("Loading"),j=(0,l.resolveComponent)("Banner"),k=(0,l.resolveComponent)("LabeledSelect"),$=(0,l.resolveComponent)("LabeledInput");return e.$fetchState.pending?((0,l.openBlock)(),(0,l.createBlock)(N,{key:0})):((0,l.openBlock)(),(0,l.createElementBlock)("div",s,[V.errors.length?((0,l.openBlock)(),(0,l.createBlock)(j,{key:0,color:"error",closable:!0,onClose:t[0]||(t[0]=e=>V.errors=[])},{default:(0,l.withCtx)(()=>[(0,l.createElementVNode)("ul",i,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(V.errors,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)("li",{key:t},(0,l.toDisplayString)(e),1))),128))])]),_:1})):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("div",o,[(0,l.createElementVNode)("div",n,[(0,l.createVNode)(k,{value:a.value.project,label:e.t("cluster.machineConfig.latitudesh.project.label"),placeholder:e.t("cluster.machineConfig.latitudesh.project.placeholder"),options:V.projectOptions,disabled:O.isDisabled,mode:a.mode,required:"",onInput:t[1]||(t[1]=e=>a.value.project=e)},null,8,["value","label","placeholder","options","disabled","mode"])])]),(0,l.createElementVNode)("div",r,[(0,l.createElementVNode)("div",d,[(0,l.createVNode)(k,{value:a.value.region,label:e.t("cluster.machineConfig.latitudesh.region.label"),placeholder:e.t("cluster.machineConfig.latitudesh.region.placeholder"),options:V.regionOptions,disabled:O.isDisabled,mode:a.mode,required:"",onInput:t[2]||(t[2]=e=>a.value.region=e)},null,8,["value","label","placeholder","options","disabled","mode"])])]),(0,l.createElementVNode)("div",u,[(0,l.createElementVNode)("div",c,[(0,l.createVNode)(k,{value:a.value.plan,label:e.t("cluster.machineConfig.latitudesh.plan.label"),placeholder:e.t("cluster.machineConfig.latitudesh.plan.placeholder"),options:V.planOptions,disabled:O.isDisabled,mode:a.mode,required:"",onInput:t[3]||(t[3]=e=>a.value.plan=e)},null,8,["value","label","placeholder","options","disabled","mode"])])]),(0,l.createElementVNode)("div",p,[(0,l.createElementVNode)("div",h,[(0,l.createVNode)(k,{value:a.value.os,label:e.t("cluster.machineConfig.latitudesh.os.label"),placeholder:e.t("cluster.machineConfig.latitudesh.os.placeholder"),options:V.osOptions,disabled:O.isDisabled,mode:a.mode,required:"",onInput:t[4]||(t[4]=e=>a.value.os=e)},null,8,["value","label","placeholder","options","disabled","mode"])])]),(0,l.createElementVNode)("div",m,[(0,l.createElementVNode)("div",v,[(0,l.createVNode)($,{value:a.value.hostname,label:e.t("cluster.machineConfig.latitudesh.hostname.label"),placeholder:e.t("cluster.machineConfig.latitudesh.hostname.placeholder"),disabled:O.isDisabled,mode:a.mode,onInput:t[5]||(t[5]=e=>a.value.hostname=e)},null,8,["value","label","placeholder","disabled","mode"])])]),(0,l.createElementVNode)("div",b,[(0,l.createElementVNode)("div",g,[(0,l.createVNode)(k,{value:a.value.sshKey,label:e.t("cluster.machineConfig.latitudesh.sshKey.label"),placeholder:e.t("cluster.machineConfig.latitudesh.sshKey.placeholder"),options:V.sshKeyOptions,disabled:O.isDisabled,mode:a.mode,onInput:t[6]||(t[6]=e=>a.value.sshKey=e)},null,8,["value","label","placeholder","options","disabled","mode"])])]),(0,l.createElementVNode)("div",f,[(0,l.createElementVNode)("div",y,[(0,l.createVNode)(k,{value:a.value.userdata,label:e.t("cluster.machineConfig.latitudesh.userdata.label"),placeholder:e.t("cluster.machineConfig.latitudesh.userdata.placeholder"),options:V.userDataOptions,disabled:O.isDisabled,mode:a.mode,onInput:t[7]||(t[7]=e=>a.value.userdata=e)},null,8,["value","label","placeholder","options","disabled","mode"])])])]))}var V=a(7619),O=a(2589),N=a(1780),j=a(4992),k=a(7656),$=a(9726);const w="/meta/proxy/api.latitude.sh",E={components:{Loading:V.A,LabeledInput:N.o,LabeledSelect:j.A,Banner:k.l},mixins:[O.A],emits:["validationChanged"],props:{credentialId:{type:String,required:!0},value:{type:Object,required:!0},busy:{type:Boolean,default:!1},mode:{type:String,required:!0},disabled:{type:Boolean,default:!1},provider:{type:String,default:"latitudesh"}},async fetch(){if(this.errors=[],this.credentialId){try{this.credential=await this.$store.dispatch("rancher/find",{type:"cloudCredential",id:this.credentialId})}catch(e){this.credential=null}try{const[e,t,a,l,s,i]=await Promise.all([this.latitudeGet("/projects?page[size]=100"),this.latitudeGet("/regions?page[size]=100"),this.latitudeGet("/plans?filter[in_stock]=true&page[size]=100"),this.latitudeGet("/plans/operating_systems?page[size]=100"),this.latitudeGet("/ssh_keys?page[size]=100"),this.latitudeGet("/user_data?page[size]=100")]);if(this.projectOptions=(e.data||[]).map(e=>({label:`${e.attributes.name} (${e.attributes.slug||e.id})`,value:e.attributes.slug||e.id})),this.regionOptions=(t.data||[]).map(e=>{const t=e.attributes,a=t.country?.name||"";let l=t.slug;return t.name&&t.name!==t.slug&&(l+=` – ${t.name}`),a&&(l+=` (${a})`),{label:l,value:t.slug}}),this.planOptions=(a.data||[]).map(e=>{const t=e.attributes,a=t.specs||{},l=a.cpu||{},s=a.memory||{},i=a.drives||[],o=t.pricing||{},n=o.USD||{},r=[t.name||t.slug];if(l.type&&r.push(`${l.type}${l.cores?` (${l.cores}c)`:""}`),s.total&&r.push(`${s.total} GB RAM`),i.length>0){const e=i.map(e=>`${e.count||1}x ${e.size||""} ${e.type||""}`).join(", ");r.push(e)}return n.hour&&r.push(`$${n.hour}/hr`),{label:r.join(" – "),value:t.slug}}),this.osOptions=(l.data||[]).map(e=>{const t=e.attributes;let a="";return t.distro?(a=t.distro,t.version&&(a+=` ${t.version}`)):a=t.name||t.slug,{label:a,value:t.slug}}),this.sshKeyOptions=[{label:"None (driver will generate a key)",value:""},...(s.data||[]).map(e=>({label:`${e.attributes.name} (${e.attributes.fingerprint||""})`,value:e.id}))],this.userDataOptions=[{label:"None",value:""},...(i.data||[]).map(e=>({label:e.attributes.description||e.id,value:e.id}))],this.isCreate&&(!this.value.project&&this.projectOptions.length>0&&(this.value.project=this.projectOptions[0].value),!this.value.os&&this.osOptions.length>0)){const e=this.osOptions.find(e=>e.value.includes("ubuntu_22"));this.value.os=e?e.value:this.osOptions[0].value}}catch(e){this.errors=(0,$.rz)(e)}}},data(){return{credential:null,errors:[],projectOptions:[],regionOptions:[],planOptions:[],osOptions:[],sshKeyOptions:[],userDataOptions:[]}},watch:{credentialId(){this.$fetch()},"value.project"(){this.emitValidation()},"value.region"(){this.emitValidation()},"value.plan"(){this.emitValidation()},"value.os"(){this.emitValidation()}},computed:{isView(){return"view"===this.mode},isCreate(){return"create"===this.mode},isDisabled(){return this.disabled||this.busy||this.isView}},methods:{async latitudeGet(e){const t=`${w}${e}`,a=await fetch(t,{headers:{"X-Api-CattleAuth-Header":`Bearer credID=${this.credentialId} passwordField=apiToken`,Accept:"application/json"}});if(!a.ok)throw new Error(`Latitude.sh API error: ${a.status} ${a.statusText}`);return await a.json()},emitValidation(){const e=!!(this.value.project&&this.value.region&&this.value.plan&&this.value.os);this.$emit("validationChanged",e)}}};var B=a(7433);const D=(0,B.A)(E,[["render",C]]),I=D},1177(e,t,a){var l={"./classic/metadata.json":9621,"./csp/metadata.json":6471,"./federal/metadata.json":1862,"./harvester/metadata.json":1507,"./rgs/metadata.json":8401,"./suse/metadata.json":7259};function s(e){var t=i(e);return a(t)}function i(e){if(!a.o(l,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return l[e]}s.keys=function(){return Object.keys(l)},s.resolve=i,e.exports=s,s.id=1177}}]);
//# sourceMappingURL=latitudesh-0.1.4.umd.min.machine-config.js.map